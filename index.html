<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title data-i18n="pageTitle">Lector de texto</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background-color: #f5f5f5;
            font-family: "Inter", sans-serif;
        }
        #textToRead {
            min-height: 200px;
            white-space: pre-wrap;
        }
        button { transition: 0.2s; }
        button:hover { opacity: 0.9; transform: translateY(-1px); }
    </style>
</head>

<body class="p-4 flex justify-center min-h-screen">

<div id="app" class="w-full max-w-3xl p-6 bg-white rounded-xl shadow-xl space-y-6 border">

    <!-- TÃTULO -->
    <h1 class="text-3xl font-extrabold text-center text-gray-800" data-i18n="mainTitle">
        Lector de texto
    </h1>

    <!-- SUBTÃTULO -->
    <p class="text-center text-gray-500 text-sm sm:text-base" data-i18n="subTitle">
        Carga un PDF, pega texto, ajusta el volumen y navega. Haz clic o selecciona texto para empezar a leer.
    </p>

    <!-- SelecciÃ³n de idioma -->
    <div class="flex justify-center">
        <div class="flex items-center gap-3 bg-gray-100 px-4 py-2 rounded-lg border">
            <label class="font-semibold text-gray-700" data-i18n="labelLanguage">Idioma:</label>
            <select id="languageSelect" class="border p-1 rounded">
                <option value="es">EspaÃ±ol ðŸ‡ªðŸ‡¸</option>
                <option value="en">InglÃ©s ðŸ‡ºðŸ‡¸</option>
            </select>
        </div>
    </div>

    <!-- Ãrea de texto -->
    <div>
        <label for="textToRead" class="font-bold mb-2 block text-gray-700" data-i18n="labelTextarea">
            Texto a leer:
        </label>
        <textarea id="textToRead"
                  placeholder="Escribe o pega el texto aquÃ­..."
                  data-i18n-placeholder="placeholderTextarea"
                  class="w-full p-4 border-2 border-gray-300 rounded-lg resize-none focus:border-blue-500 focus:ring-blue-500">
        </textarea>
    </div>

    <!-- Controles -->
    <div class="flex flex-col sm:flex-row justify-center gap-4">

        <button id="playBtn"
                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-full font-bold shadow-md"
                data-i18n="buttonPlay">
            Reproducir
        </button>

        <button id="stopBtn"
                class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-full font-bold shadow-md"
                data-i18n="buttonStop">
            Detener
        </button>
    </div>

    <!-- Mensajes -->
    <div id="messageArea" class="hidden mt-4 text-center p-3 rounded-lg text-sm font-semibold"></div>

</div>

<script>
/* -------------------- TRADUCCIONES -------------------- */

const translations = {
    es: {
        pageTitle: "Lector de texto",
        mainTitle: "Lector de texto",
        subTitle: "Carga un PDF, pega texto, ajusta el volumen y navega. Haz clic o selecciona texto para empezar a leer.",
        labelLanguage: "Idioma:",
        labelTextarea: "Texto a leer:",
        placeholderTextarea: "Escribe o pega el texto aquÃ­...",
        buttonPlay: "Reproducir",
        buttonStop: "Detener",
        alertNoText: "No hay texto para leer.",
        alertUnsupported: "La funciÃ³n de voz no es compatible con este dispositivo."
    },
    en: {
        pageTitle: "Text reader",
        mainTitle: "Text reader",
        subTitle: "Upload a PDF, paste text, adjust volume and navigate. Click or select text to start reading.",
        labelLanguage: "Language:",
        labelTextarea: "Text to read:",
        placeholderTextarea: "Write or paste text here...",
        buttonPlay: "Play",
        buttonStop: "Stop",
        alertNoText: "There is no text to read.",
        alertUnsupported: "Speech synthesis is not supported on this device."
    }
};

let currentLang = "es";

/* APLICAR IDIOMA */
function applyLanguage() {
    const t = translations[currentLang];

    document.title = t.pageTitle;

    document.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        if (t[key]) el.textContent = t[key];
    });

    document.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
        const key = el.getAttribute("data-i18n-placeholder");
        if (t[key]) el.placeholder = t[key];
    });
}

/* -------------------- TTS -------------------- */

const synth = window.speechSynthesis;
let speaking = false;
let utterance = null;

function showMessage(text, color="yellow") {
    const msg = document.getElementById("messageArea");
    msg.className = `mt-4 text-center p-3 rounded-lg text-sm font-semibold bg-${color}-100 border border-${color}-300 text-${color}-800`;
    msg.textContent = text;
    msg.classList.remove("hidden");

    setTimeout(() => msg.classList.add("hidden"), 3000);
}

document.getElementById("playBtn").onclick = () => {
    const text = document.getElementById("textToRead").value.trim();
    if (!text) return showMessage(translations[currentLang].alertNoText, "red");

    if (!synth) return showMessage(translations[currentLang].alertUnsupported, "red");

    utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = currentLang === "es" ? "es-ES" : "en-US";

    synth.speak(utterance);
    speaking = true;
};

document.getElementById("stopBtn").onclick = () => {
    if (synth.speaking) synth.cancel();
    speaking = false;
};

/* CAMBIO DE IDIOMA */
document.getElementById("languageSelect").onchange = (e) => {
    currentLang = e.target.value;
    applyLanguage();
};

/* inicio */
applyLanguage();

</script>

</body>
</html>
